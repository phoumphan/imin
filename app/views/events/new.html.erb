<% content_for :head do %>
  <%= javascript_include_tag 'jquery.tokeninput' %>
  <%= stylesheet_link_tag 'token-input'  %>
<script src="http://maps.google.com/maps?file=api&v=2&key=abcdefg&sensor=false"
        type="text/javascript">
</script>
<script src="http://gmaps-utility-library.googlecode.com/svn/trunk/markermanager/release/src/markermanager.js"
        type="text/javascript">
</script>
<script src="/javascripts/MapCommon.js"
        type="text/javascript">
</script>
<script type="text/javascript">
<!--
var marker = null;

function placemarker(overlay, latlng, overlaylatlng) {
  if (!marker) {
    marker = new GMarker(latlng, { draggable: true });
    map.addOverlay(marker);
  } else {
    marker.setLatLng(latlng);
  }
}

function initialize() {
  basic_init();

  GEvent.addListener(map, "click", placemarker);
}

function submitForm() {
  if (marker) {
    document.getElementById('event_location').value = marker.getLatLng().lat() + ',' + marker.getLatLng().lng();
    document.form.submit();
  } else {
    alert("Please place the location on the map.");
  }
}


//-->
</script>
<% end %>

<% content_for :body_attributes do %>
onLoad="initialize();"
onUnload="GUnload();"
<% end %>

<div id="user_nav">
        <%if current_user%>
          <%=link_to 'Profile', {:controller => 'users', :action => 'profile'}, :class => 'user_nav_link'%>
          <%=link_to 'Create Event', {:controller => 'events', :action => 'new'}, :class => 'user_nav_link_on'%>
          <%=link_to 'My Preferences', {:controller => 'users', :action => 'preferences'}, :class => 'user_nav_link'%>
          <%=link_to 'Friends', {:controller => 'friendships', :action => 'display'}, :class => 'user_nav_link'%>
           <%=link_to 'Edit', {:controller => 'users', :action => 'edit_info'}, :class => 'user_nav_link'%>
      <%end%>
</div>
<div class="user_profile_container">
  <div class="user_profile">
    <div id="wrapper">
<%form_for @event, :action => 'create', :html => { :multipart => true, :name => "form" } do |f|%>
  <%=f.error_messages%>
  <table id="event_table">
  <tr>
    <td>Event Name:</td>
    <td><%=f.text_field :name%></td>
  </tr>

  <tr><td>Event Description:</td>
  <td><%=f.text_area :description, :style => 'height:60px'%></td></tr>


  <tr><td><%=f.label :start_at, 'Event Starts At:'%></td>
  <td><%= f.text_field :start_at %></td></tr>

  <tr><td><%=f.label :end_at, 'Event Ends At:  '%></td>
  <td><%=f.text_field :end_at%></td></tr>

 
  <tr>
    <td>Location:</td>
    <td><div id="map_canvas" style="width: 500px; height: 300px; padding: 0; margin: 0; margin-bottom: 15px;"></div></td>
  </tr>

  <tr><td>Dress Code:</td>
  <td><%=f.select :formality, ['Formal', 'Dressy', 'Dressy-Casual', 'Casual']%></td></tr>

  <tr><td>Price:</td><td>
  <%=f.text_field :cost, :size => 10%> &nbsp; Dollars</td></tr>

  <tr><td>Event Privacy:</td>
  <td><%=f.select :public, ['Private', 'Public']%></td></tr>
  
  </table>

  <div id='eventtypes'>
  </div>
  <%=link_to_remote 'Add an Event Tag', :url => {:action => 'add_eventtype'}%>
  <br /><br />

  
  <%=f.hidden_field :location%>

  <input type="button" value="Create Event" onclick="submitForm();" />
<%end%>
    </div>
    </div>
  </div>

